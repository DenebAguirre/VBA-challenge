Sub ticker_evaluation()For Each ws In Worksheets ws.Activate   Dim Lastrow As Double    Dim Tickername As String    Dim Tickerlist As Integer    Dim Totalvolume As Double        Dim Startprice As Double    Dim Endprice As Double    Dim rangenumber As Double    Dim diference As Double          y = 0 Tickerlist = 2 Totalvolume = 0 Lastrow = ws.UsedRange.Rows.CountFor i = 2 To Lastrow   If Cells(i + 1, 1).Value = Cells(i, 1).Value Then    rangenumber = rangenumber + 1    Totalvolume = Totalvolume + Cells(i, 7).Value                If rangenumber = 1 Then             Startprice = Cells(i, 3).Value             End If    Else        Tickername = Cells(i, 1).Value        Endprice = Cells(i, 6).Value    Range("I" & Tickerlist).Value = Tickername        Totalvolume = Totalvolume + Cells(i, 7).Value    Range("L" & Tickerlist).Value = Totalvolume        diference = Startprice - Endprice        Range("J" & Tickerlist).Value = diference                If diference < 0 Then                        Range("J" & Tickerlist).Interior.ColorIndex = 3                    Else                        Range("J" & Tickerlist).Interior.ColorIndex = 4                End If                            Range("K" & Tickerlist).Value = diference / Startprice        Range("K" & Tickerlist).NumberFormat = "0.00%"                      Tickerlist = Tickerlist + 1         Totalvolume = 0    End IfNext i    Cells(1, 9).Value = "Ticker"    Cells(1, 10).Value = "Yearly Change"    Cells(1, 11).Value = "Percent Change"    Cells(1, 12).Value = "Total Volume"            Dim Lastrow2 As DoubleDim Largerwin As DoubleDim WinnerTicker As StringDim Largerlost As DoubleDim LoserTicker As StringDim Largervolume As DoubleDim Tickervolume As StringLargerlost = 0Largervolume = 0Largerwin = 0Lastrow2 = Cells(Rows.Count, "I").End(xlUp).RowFor i = 2 To Lastrow2  If Cells(i, 10).Value > Largerwin Then    Largerwin = Cells(i, 11).Value    WinnerTicker = Cells(i, 9).Value    End If   If Cells(i, 10).Value < Largerlost Then    Largerlost = Cells(i, 11).Value    LoserTicker = Cells(i, 9).Value    End If   If Cells(i, 12).Value > Largervolume Then    Largervolume = Cells(i, 12).Value    Tickervolume = Cells(i, 9).Value    End If    Next i    Cells(2, 15).Value = "Greatest % increase"    Cells(3, 15).Value = "Greatest % decrease"    Cells(4, 15).Value = "Greatest Total Volume"        Cells(2, 16).Value = WinnerTicker    Cells(3, 16).Value = LoserTicker    Cells(4, 16).Value = Tickervolume        Cells(2, 17).Value = Largerwin    Cells(2, 17).NumberFormat = "0.00%"    Cells(3, 17).Value = Largerlost    Cells(3, 17).NumberFormat = "0.00%"    Cells(4, 17).Value = Largervolume        Cells(1, 16).Value = "Ticker"    Cells(1, 17).Value = "Value"        Next ws  End Sub